/* 速度プリセット（動きを減らす にも対応） */
@media (prefers-reduced-motion: reduce) {
  :root { --dur: .45s; --slow: .55s; }
}
@media (prefers-reduced-motion: no-preference) {
  :root { --dur: .9s; --slow: 1.1s; }
}

:root{
  --bg:#000;
  --ink:#e9e2da;
  --gold:#d6b877;
  --soft:#0c0c10;
  --glow: rgba(255,236,200,.35);
}

*{ box-sizing:border-box; }
html,body{ height:100%; margin:0; }
body.intro{
  background: radial-gradient(1200px 900px at 50% 60%, #0b0b10 0%, #000 60%);
  color: var(--ink);
  font-family: "Shippori Mincho B1","Yu Mincho","Hiragino Mincho ProN",serif;
  overflow:hidden;
}

/* 舞台 */
.stage{ position:relative; width:100vw; height:100vh; }

/* 星屑キャンバス */
#stars{
  position:absolute; inset:0; width:100%; height:100%;
  display:block; filter: brightness(.9);
}

/* 周辺減光＋紙質感 */
.vignette{
  position:absolute; inset:-10vmax; pointer-events:none;
  background:
    radial-gradient(ellipse at center, transparent 45%, rgba(0,0,0,.55) 80%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.018) 0 1px, rgba(0,0,0,0) 1px 2px);
  mix-blend-mode: overlay;
  opacity:.45;
}

/* 題字 */
.title{
  position:absolute; right:min(8vw, 84px); top:50%;
  transform: translateY(-50%); opacity:0;
  text-align:left;
  animation: titleIn var(--slow) ease forwards; animation-delay: 1.2s;
}
.title h1{
  margin:0;
  font-weight:800;
  font-size: clamp(30px, 6.5vw, 62px);
  letter-spacing:.14em;
  color:#f4efe8;
  -webkit-text-stroke: .8px rgba(210,180,120,.35);
  text-shadow:
    0 0 24px rgba(255,240,210,.28),
    0 0 2px rgba(255,255,255,.9);
}
.title .subtitle{
  margin:.9rem 0 0;
  letter-spacing:.08em;
  color:#cabab1;
  opacity:0; transform: translateY(6px);
  animation: subIn var(--dur) ease forwards; animation-delay: 1.7s;
}

/* 紋章（中央） */
.crest{
  position:absolute; left:50%; top:52%;
  width:min(74vmin, 760px); height:min(74vmin, 760px);
  transform: translate(-50%,-50%);
}
.ring{
  position:absolute; left:50%; top:50%;
  width:100%; height:100%; object-fit:contain;
  transform: translate(-50%,-50%) scale(.94) rotate(0deg);
  opacity:0;
  filter: drop-shadow(0 0 10px rgba(255,226,170,.22));
  animation:
    ringIn var(--dur) ease forwards 3.8s,
    ringSpin 18s linear infinite 3.8s;
}
.shafts{
  position:absolute; left:50%; top:50%;
  width:110%; height:110%; object-fit:contain;
  transform: translate(-50%,-50%) scale(1.04);
  mix-blend-mode: screen; opacity:0;
  filter: brightness(1.05) contrast(1.08);
animation: shaftsIn 1.2s ease-out forwards 8s, glowPulse 4s ease-in-out infinite 9s;

}
.crown {
  position: absolute;
  left: 50%;
  top: 35%;
  width: min(18vmin, 230px);
  height: auto;
  object-fit: contain;
  opacity: 0;
  transform: translate(-50%, -60%) scale(1.08) rotate(-6deg);
  filter: drop-shadow(0 0 0px rgba(255, 248, 220, 0));
  /* 光の筋とほぼ同時にフェードイン開始（7.9秒） */
  animation:
    crownIn 1.4s ease-out forwards 7.9s;
}


/* ホワイトアウト→遷移 */
.whiteout{
  position:absolute; inset:0; background:#fff;
  opacity:0; pointer-events:none;
  animation: whiteOut 1.0s ease forwards 10.5s;
}

/* UI */
.ui{
  position:absolute; z-index:5;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.15);
  color:#e9e1d9; padding:.45rem .7rem; font-size:.85rem;
  letter-spacing:.06em; border-radius:8px;
  backdrop-filter: blur(6px);
}
.skip { right:18px; top:16px; }
.sound{ left:18px; bottom:16px; }
.sound[aria-pressed="true"]{ background: rgba(255,255,255,.14); }

/* アニメーション */
@keyframes titleIn{ to{ opacity:1; transform: translateY(-50%) } }
@keyframes subIn{   to{ opacity:.92; transform: translateY(0) } }
@keyframes ringIn{  to{ opacity:1; transform: translate(-50%,-50%) scale(1) rotate(0deg) } }
@keyframes ringSpin{to{ transform: translate(-50%,-50%) scale(1) rotate(360deg) } }
@keyframes crownIn {
  0% {
    opacity: 0;
    transform: translate(-50%, -60%) scale(1.08) rotate(-6deg);
    filter: drop-shadow(0 0 0px rgba(255, 248, 220, 0));
  }
  40% {
    opacity: 0.5;
    transform: translate(-50%, -54%) scale(1.02) rotate(-4deg);
    filter: drop-shadow(0 0 8px rgba(255, 248, 220, 0.2));
  }
  70% {
    opacity: 0.9;
    transform: translate(-50%, -50%) scale(1) rotate(-3deg);
    filter: drop-shadow(0 0 15px rgba(255, 248, 220, 0.35));
  }
  100% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1) rotate(-2deg);
    filter: drop-shadow(0 0 20px rgba(255, 248, 220, 0.45));
  }
}

@keyframes shaftsIn{
  0%  { opacity:0;   transform: translate(-50%,-50%) scale(1.05); }
  60% { opacity:.85; transform: translate(-50%,-50%) scale(1.01); }
  100%{ opacity:.80; transform: translate(-50%,-50%) scale(1); }
}
@keyframes whiteOut{ to{ opacity:1 } }

/* 動きを減らす */
@media (prefers-reduced-motion: reduce) {
  .title{ animation-duration:.3s; }
  .ring{  animation: ringIn .3s ease forwards 1.2s; }
  .crown{ animation: crownIn .3s ease forwards 1.3s; }
  .shafts{animation: shaftsIn .4s ease forwards 2s; }
  .whiteout{ animation: whiteOut .6s ease forwards 2.7s; }
}
@keyframes glowPulse {
  0%, 100% { filter: brightness(1.05) contrast(1.08); }
  50% { filter: brightness(1.2) contrast(1.15); }
}
/* Seraphia silhouette */
.seraphia {
  position: absolute;
  left: 50%;
  top: 54%;
  width: min(45vmin, 520px);
  height: auto;
  transform: translate(-50%, -50%) scale(1.02);
  opacity: 0;
  filter: brightness(1.05) contrast(1.1) drop-shadow(0 0 12px rgba(255, 255, 255, 0.15));
  mix-blend-mode: screen;
  z-index: 2;
  animation:
    seraphiaIn 1.4s ease forwards 7.9s,  /* 光と一緒に浮かび上がる */
    seraphiaStep 1.4s steps(2, end) 8.2s; /* カクカクした動き */
}


@keyframes seraphiaIn {
  from { opacity: 0; transform: translate(-50%, -50%) scale(1.04); }
  to { opacity: 0.95; transform: translate(-50%, -50%) scale(1.0); }
}
@keyframes seraphiaStep {
  0% { transform: translate(-50%, -51%) scale(1.0); }
  50% { transform: translate(-50%, -49%) scale(1.0); }
  100% { transform: translate(-50%, -50%) scale(1.0); }
}

/* 囁き字幕 */
.whisper{
  position:absolute; left:0; right:0; bottom:9vh;
  text-align:center;
  font-family: "Yu Mincho", "Hiragino Mincho ProN", serif;
  font-size: clamp(14px, 2.6vw, 18px);
  color:#e9e1d9;
  letter-spacing:.12em;
  opacity:0;
  text-shadow: 0 0 10px rgba(255,236,200,.25);
  pointer-events:none;
}
.whisper.show{ animation: whisperIn .8s ease forwards; }
@keyframes whisperIn{ to{ opacity:.95; transform: translateY(-2px);} }

/* “光と一緒に浮かぶ”ための小調整（既存 crown/shafts がある前提） */
.crown{ animation-delay: 8s; }   /* 光の筋の出現と合わせるならここを 8s に */
.shafts{ animation-delay: 8s; }  /* 既に 8s ならそのまま */
#stars {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  background: radial-gradient(ellipse at bottom, #0a0a0e 0%, #000 100%);
  filter: brightness(0.9);
}
