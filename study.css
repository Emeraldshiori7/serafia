:root{
  --ink:#e9dfd6;
  --bg:#050509;
  --gold:#d8b980;
  --gold-soft:rgba(216,185,128,.32);
}

*{ box-sizing:border-box; }
html,body{ margin:0; height:100%; }

body.study{
  font-family:"Cormorant Garamond","Yu Mincho",serif;
  color:var(--ink);
  background: radial-gradient(120% 140% at 50% 0%, #151522 0%, #050509 50%, #000 100%);
  overflow:hidden;
}

/* 背景の星 */
#dust{
  position:fixed;
  inset:0;
  z-index:0;
  display:block;
}

/* タイトル帯 */
.study-header{
  position:fixed;
  top:0; left:0; right:0;
  z-index:10;
  padding:10px 18px 8px;
  background:linear-gradient(to bottom, rgba(5,5,10,.95), rgba(5,5,10,.7), transparent);
  border-bottom:1px solid rgba(255,255,255,.05);
  backdrop-filter: blur(10px);
}
.study-header__inner{
  max-width:1200px;
  margin:0 auto;
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:1.5rem;
}
.study-header h1{
  margin:0;
  font-family:"Cinzel",serif;
  letter-spacing:.16em;
  font-size:clamp(22px, 3vw, 30px);
  text-transform:uppercase;
  color:#f5eee4;
}
.study-header .tagline{
  margin:.1rem 0 0;
  font-size:clamp(11px, 1.7vw, 13px);
  color:#b9afa4;
}
.back-link{
  margin-top:.2rem;
  font-size:12px;
  letter-spacing:.18em;
  text-decoration:none;
  text-transform:uppercase;
  color:#e4d5c0;
  padding:.3rem .7rem;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(10,10,14,.5);
  box-shadow:0 0 14px rgba(0,0,0,.7);
  transition:background .25s ease, transform .2s ease, border-color .25s ease;
}
.back-link:hover{
  background:rgba(255,255,255,.06);
  border-color:rgba(255,255,255,.25);
  transform:translateY(-1px);
}

/* メイン */
.study-main{
  position:relative;
  z-index:1;
  padding:82px 16px 18px;
  height:100vh;
}
.study-grid{
  max-width:1200px;
  height:100%;
  margin:0 auto;
  display:grid;
  grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.3fr) minmax(260px, .8fr);
  gap:18px;
}

/* 汎用パネル・カード */
.panel{
  position:relative;
  display:flex;
  flex-direction:column;
  gap:14px;
}
.card{
  position:relative;
  padding:14px 16px 16px;
  border-radius:16px;
  background:
    radial-gradient(140% 180% at 0% 0%, rgba(255,255,255,.12), transparent 60%),
    radial-gradient(160% 220% at 100% 100%, rgba(0,0,0,.85), rgba(0,0,0,.98));
  background-color:rgba(5,5,10,.96);
  border:1px solid rgba(255,255,255,.06);
  box-shadow:
    0 20px 40px rgba(0,0,0,.85),
    0 0 0 1px rgba(180,150,100,.18) inset;
  backdrop-filter: blur(12px);
}
.card__title{
  margin:0 0 .4rem;
  font-size:13px;
  letter-spacing:.22em;
  text-transform:uppercase;
  color:#f0e1ca;
}
.card__title--small{
  font-size:12px;
}

/* 時間表示ブロック */
.time-display{
  margin:.4rem 0 .6rem;
  font-family:"Cinzel",serif;
  font-size:clamp(26px, 3.3vw, 32px);
  letter-spacing:.18em;
  text-align:center;
}
.time-display--small{
  font-size:clamp(22px, 2.7vw, 26px);
}
.time-controls{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
}

/* ボタン */
.btn{
  position:relative;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  padding:.3rem .9rem;
  font-size:12px;
  letter-spacing:.14em;
  text-transform:uppercase;
  background:rgba(10,10,14,.7);
  color:#f0e7dd;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:4px;
  box-shadow:0 6px 18px rgba(0,0,0,.8);
  transition:background .25s ease, transform .18s ease, box-shadow .25s ease, border-color .25s;
}
.btn.primary{
  border-color:rgba(255,215,160,.45);
  background:linear-gradient(120deg, rgba(215,185,120,.35), rgba(40,30,10,.8));
}
.btn.ghost{
  background:transparent;
}
.btn.small{
  padding:.25rem .6rem;
  font-size:11px;
}
.btn:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 26px rgba(0,0,0,.9);
  background:rgba(255,255,255,.06);
}
.btn.primary:hover{
  background:linear-gradient(120deg, rgba(230,200,150,.6), rgba(35,25,12,.95));
}

/* タイマー入力 */
.timer-input{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:12px;
  color:#cbbfb3;
}
.timer-input input{
  width:64px;
  padding:.15rem .35rem;
  border-radius:8px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(5,5,10,.9);
  color:#f0e7dd;
  font-family:inherit;
}

/* 直近の計測 */
.card--last .last-label{
  margin:.2rem 0;
  font-size:12px;
  color:#d2c7ba;
}
.card--last #last-time{
  font-family:"Cinzel",serif;
  letter-spacing:.16em;
}
.last-hint{
  margin:.2rem 0 0;
  font-size:11px;
  color:#a79b8d;
}

/* ログフォーム */
.log-form{
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-top:.3rem;
}
.form-row{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.form-row--split{
  flex-direction:row;
  gap:10px;
}
.form-row--split > label{
  flex:1;
}
label{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.16em;
  color:#c8bcac;
}
input[type="text"],
select,
textarea{
  margin-top:4px;
  width:100%;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(8,8,12,.95);
  color:#f0e7dd;
  padding:.3rem .5rem;
  font-family:inherit;
  font-size:13px;
  resize:vertical;
}
textarea{
  min-height:56px;
}
input[readonly]{
  opacity:.8;
}
.form-actions{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
  margin-top:4px;
}

/* ログ一覧 */
.card--history{
  flex:1;
  min-height:0;
  display:flex;
  flex-direction:column;
}
.history-summary{
  font-size:11px;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:#c8bcae;
  margin-bottom:.25rem;
}
.history-list{
  flex:1;
  min-height:0;
  overflow:auto;
  padding-right:4px;
}
.history-empty{
  font-size:12px;
  color:#a89c90;
  margin:.4rem 0 0;
}
.log-item{
  padding:.35rem .5rem .4rem;
  margin-bottom:4px;
  border-radius:10px;
  background:rgba(10,10,16,.86);
  border:1px solid rgba(255,255,255,.08);
}
.log-item__top{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  gap:6px;
  margin-bottom:2px;
}
.log-item__subject{
  font-size:13px;
}
.log-item__time{
  font-family:"Cinzel",serif;
  font-size:11px;
  letter-spacing:.16em;
}
.log-item__meta{
  font-size:11px;
  color:#b4aa9d;
}
.log-item__note{
  font-size:12px;
  margin-top:2px;
}

/* セラフィアパネル */
.panel--seraphia{
  align-items:center;
  justify-content:flex-start;
  padding-top:6px;
}
.seraphia-frame{
  position:relative;
  width:100%;
  max-width:260px;
  aspect-ratio:3/5;
  margin:0 auto 10px;
  border-radius:24px;
  background:radial-gradient(130% 160% at 50% 0%, rgba(255,255,255,.16), rgba(0,0,0,1));
  box-shadow:
    0 28px 50px rgba(0,0,0,.95),
    0 0 40px rgba(215,185,128,.45);
  overflow:hidden;
}
.seraphia-portrait{
  position:absolute;
  inset:4% 6%;
  background:url('assets/seraphia/seraphia_manifest.png') center/contain no-repeat;
  mix-blend-mode:screen;
  filter:grayscale(100%) contrast(125%) brightness(125%);
  opacity:.9;
}
.seraphia-glow{
  position:absolute;
  inset:-10%;
  background:
    radial-gradient(70% 90% at 50% 0%, rgba(255,255,255,.28), transparent 70%),
    radial-gradient(80% 90% at 50% 100%, rgba(215,185,128,.18), transparent 70%);
  mix-blend-mode:screen;
  opacity:.7;
  filter:blur(14px);
  animation:seraphiaPulse 8s ease-in-out infinite;
}
@keyframes seraphiaPulse{
  0%,100%{ opacity:.65; filter:blur(14px) }
  50%    { opacity:.9;  filter:blur(20px) }
}
.seraphia-line{
  font-size:13px;
  line-height:1.7;
  text-align:center;
  color:#d5c9bd;
  text-shadow:0 0 16px rgba(0,0,0,.9);
  white-space:pre-line;
}

/* レイアウト調整（タブレット以下） */
@media (max-width: 1024px){
  .study-grid{
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.2fr);
    grid-template-rows:auto auto;
  }
  .panel--seraphia{
    grid-column:1 / -1;
    flex-direction:row;
  }
  .seraphia-frame{
    max-width:220px;
    margin:0 12px 0 0;
  }
  .seraphia-line{
    text-align:left;
  }
}

/* スマホ */
@media (max-width: 720px){
  .study-main{
    padding-top:76px;
  }
  .study-grid{
    grid-template-columns: minmax(0,1fr);
    grid-auto-rows:auto;
    height:auto;
  }
  body.study{
    overflow:auto;
  }
  .panel--seraphia{
    padding-bottom:18px;
  }
}
/* 儀式チェックリスト */
.card--ritual{
  background: radial-gradient(120% 160% at 50% 0%, rgba(255,255,255,.1), rgba(0,0,0,.95));
  border:1px solid rgba(255,255,255,.1);
}

.ritual-progress{
  font-size:12px;
  color:#d9cdb8;
  margin-bottom:6px;
}
.ritual-bar{
  width:100%;
  height:6px;
  border-radius:6px;
  background:rgba(255,255,255,.06);
  overflow:hidden;
  margin-top:4px;
}
#ritual-bar-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg, rgba(215,185,120,.6), rgba(255,240,200,.9));
  transition:width .3s ease;
}

.ritual-list{
  list-style:none;
  padding:0;
  margin:6px 0 10px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.ritual-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:rgba(10,10,16,.8);
  border:1px solid rgba(255,255,255,.08);
  border-radius:10px;
  padding:6px 10px;
  font-size:13px;
  cursor:pointer;
  transition:all .25s ease;
}
.ritual-item.completed{
  color:#d8c78f;
  text-decoration:line-through;
  border-color:rgba(215,185,120,.4);
  background:rgba(255,240,180,.1);
  box-shadow:0 0 12px rgba(215,185,120,.2);
}
.ritual-item:hover{
  border-color:rgba(255,255,255,.2);
}
.ritual-actions{
  display:flex;
  gap:6px;
}
#ritual-input{
  flex:1;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(8,8,12,.95);
  color:#f0e7dd;
  padding:.3rem .5rem;
  font-family:inherit;
}
.card--ritual{
  background: radial-gradient(120% 160% at 50% 0%, rgba(255,255,255,.1), rgba(0,0,0,.95));
  border:1px solid rgba(255,255,255,.1);
}

.ritual-progress{
  font-size:12px;
  color:#d9cdb8;
  margin-bottom:6px;
}
.ritual-bar{
  width:100%;
  height:6px;
  border-radius:6px;
  background:rgba(255,255,255,.06);
  overflow:hidden;
  margin-top:4px;
}
#ritual-bar-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg, rgba(215,185,120,.6), rgba(255,240,200,.9));
  transition:width .3s ease;
}

.ritual-list{
  list-style:none;
  padding:0;
  margin:6px 0 10px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.ritual-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:rgba(10,10,16,.8);
  border:1px solid rgba(255,255,255,.08);
  border-radius:10px;
  padding:6px 10px;
  font-size:13px;
  cursor:pointer;
  transition:all .25s ease;
}
.ritual-item.completed{
  color:#d8c78f;
  text-decoration:line-through;
  border-color:rgba(215,185,120,.4);
  background:rgba(255,240,180,.1);
  box-shadow:0 0 12px rgba(215,185,120,.2);
}
.ritual-item:hover{
  border-color:rgba(255,255,255,.2);
}
.ritual-actions{
  display:flex;
  gap:6px;
}
#ritual-input{
  flex:1;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.18);
  background:rgba(8,8,12,.95);
  color:#f0e7dd;
  padding:.3rem .5rem;
  font-family:inherit;
}
/* 学習記録・連続日数 */
.card--stats{
  background: radial-gradient(140% 180% at 50% 0%, rgba(255,255,255,.06), rgba(0,0,0,.96));
  border:1px solid rgba(255,255,255,.1);
}

.stats{
  margin:4px 0 10px;
  padding:0;
}
.stats__row{
  display:flex;
  justify-content:space-between;
  gap:10px;
  font-size:13px;
  padding:3px 0;
}
.stats__row dt{
  color:#c6bbad;
}
.stats__row dd{
  margin:0;
  font-variant-numeric: tabular-nums;
  color:#f3eadf;
}

#stat-add-manual{
  margin-top:6px;
}
