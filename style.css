:root{
  --ink:#e9dfd6; --bg:#000; --gold:#d5bd86;
  --panel:rgba(255,240,230,0.05); --glow:rgba(255,236,200,.35);
}

/* 基本 */
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body.hall{
  font-family:"Cormorant Garamond","Yu Mincho",serif;
  color:var(--ink); background:var(--bg); letter-spacing:.03em;
  overflow-x:hidden;
}

/* 背景 */
.bg{position:fixed;inset:0;z-index:-1;pointer-events:none;
  background:radial-gradient(1200px 800px at 50% 55%, #0b0b0f 0%, #000 65%)}
#dust{position:absolute;inset:0;display:block;filter:brightness(.9) contrast(1.05)}
.vignette{position:absolute;inset:-8vmax;
  background:radial-gradient(ellipse at 50% 40%, transparent 45%, rgba(0,0,0,.65) 80%)}
.floor-glow{position:absolute;left:50%;bottom:-8vh;transform:translateX(-50%);
  width:min(90vw,1100px);height:26vh;
  background:radial-gradient(60% 100% at 50% 0%, rgba(170,160,140,.18), transparent 70%);
  filter:blur(10px)}

/* 奥のレリーフ */
.relief{
  position:absolute; inset:0; opacity:.22; filter:blur(.2px);
  animation:reliefFloat 18s ease-in-out infinite alternate;
  background:
    repeating-conic-gradient(from 45deg, rgba(255,240,220,.045) 0 25%, transparent 0 50%) 0 0/38px 38px,
    radial-gradient(closest-side, rgba(255,240,220,.06) 0%, rgba(255,240,220,.015) 55%, transparent 62%) 24px 20px/120px 120px repeat,
    linear-gradient(#070709, #000);
}
@keyframes reliefFloat{from{transform:translateY(-4px);opacity:.20}to{transform:translateY(4px);opacity:.25}}
@media (prefers-reduced-motion:reduce){.relief{animation:none}}

/* タイトル */
.hero{ text-align:center; padding:8vh 2rem 2rem }
.hero h1{
  margin:0; font-family:"Cinzel",serif; letter-spacing:.18em; font-weight:600;
  font-size:clamp(28px,6vw,60px); text-shadow:0 0 18px var(--glow);
  transform:translateY(6px); opacity:0; animation:fadeUp .9s ease .2s forwards;
}
.subtitle{ margin:.6rem 0 0; color:#b8aca4; opacity:0; transform:translateY(8px); animation:fadeUp .8s ease .6s forwards }
@keyframes fadeUp{to{opacity:1; transform:translateY(0)}}

/* ───────── 祭壇ステージ ───────── */
.hall-stage{
  position: relative;
  width: min(1100px, 92vw);
  height: min(68vh, 640px);
  margin: 2rem auto 6vh;
  isolation: isolate;
}

/* 楕円リングの外枠にフィット */
.hall-stage .doors--orbit{
  position: absolute;
  inset: 0;
  margin: 0; width: 100%; height: 100%;
}

/* 扉の基本スタイル（共通） */
.door{
  position:relative; aspect-ratio:3/4; border-radius:10px; overflow:hidden; text-decoration:none;
  display:flex; align-items:end; justify-content:center; padding:14px 10px; color:#f1e9df; letter-spacing:.12em;
  background:
    radial-gradient(180% 100% at 50% 0%, rgba(255,220,160,.06), transparent 60%),
    repeating-linear-gradient(90deg,#0b0b0d 0 6px,#0f0f12 6px 12px),
    linear-gradient(180deg,#0a0a0c,#141419);
  box-shadow:
    inset 0 0 0 1px rgba(235,205,120,.25),
    inset 0 0 0 6px rgba(235,205,120,.06),
    inset 0 0 24px rgba(0,0,0,.65),
    0 0 25px rgba(255,220,140,.06);
  transition: transform .35s ease, box-shadow .35s ease, filter .35s ease;
  filter: grayscale(20%) contrast(104%) brightness(92%);
}
.door::before{content:""; position:absolute; inset:8px; border-radius:8px;
  border:1px solid rgba(235,205,120,.45); box-shadow: inset 0 0 12px rgba(235,205,120,.15); mix-blend-mode:screen; opacity:.9}
.door::after{content:""; position:absolute; inset:16px; border-radius:6px; border:1px solid rgba(235,205,120,.25); box-shadow: inset 0 0 18px rgba(235,205,120,.08); opacity:.85}
.glare{position:absolute; inset:0; background:linear-gradient(65deg,transparent 40%,rgba(255,245,210,.28) 50%,transparent 60%); transform:translateX(-120%); filter:blur(1px); opacity:0; transition:opacity .4s ease, transform .9s ease}
.sparks{position:absolute; inset:0; background:
  radial-gradient(2px 2px at 20% 30%, rgba(255,240,200,.7), transparent 60%),
  radial-gradient(1.5px 1.5px at 70% 60%, rgba(255,240,200,.5), transparent 60%),
  radial-gradient(1.5px 1.5px at 40% 75%, rgba(255,240,200,.35), transparent 60%); opacity:0; transition:opacity .6s ease}
@media (hover:hover){
  .door:hover{ transform:translateY(-4px) scale(1.02); box-shadow: inset 0 0 0 1px rgba(255,230,160,.5), inset 0 0 0 6px rgba(255,230,160,.08), inset 0 0 34px rgba(0,0,0,.6), 0 10px 35px rgba(255,210,120,.18); filter:saturate(1.08) contrast(1.05) }
  .door:hover .glare{ opacity:.9; transform:translateX(120%) }
  .door:hover .sparks{ opacity:.7 }
}
.door:focus-visible{ outline:2px solid rgba(255,230,160,.8); outline-offset:3px }
.door__label{
  position:relative; z-index:2; font-size:clamp(14px,1.5vw,18px);
  padding:.35rem .7rem; background:rgba(0,0,0,.45);
  border:1px solid rgba(235,205,120,.35); border-radius:6px; text-shadow:0 1px 0 rgba(0,0,0,.8);
  box-shadow:0 0 12px rgba(255,220,150,.08);
}

/* ───────── 楕円リング：浮遊配置 ───────── */
.hall-stage .doors--orbit .door{
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%); /* JSで上書き */
  will-change: transform, filter;
  transition: transform .45s ease, filter .45s ease;
  z-index: 1;
}
.hall-stage .doors--orbit .door[data-front="1"]{
  filter: saturate(110%) brightness(104%);
}
@media (hover:hover){
  .hall-stage .doors--orbit .door:hover{
    transform: translate(-50%,-50%) scale(1.06) !important;
  }
  .hall-stage .doors--orbit .door .glare,
  .hall-stage .doors--orbit .door .sparks{
    display:none !important;
  }
}

/* モバイル：読みやすさ優先でグリッドに退避 */
@media (max-width: 720px){
  .hall-stage{ height: auto; }
  .hall-stage .doors--orbit{
    position: static;
    display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
    width: min(92vw, 720px);
    margin: 0 auto;
    height: auto;
  }
  .hall-stage .doors--orbit .door{
    position: static; transform:none; will-change:auto; z-index:auto;
  }
}

/* ───────── セラフィア（中央固定） ───────── */
.seraphia-silhouette{
  position: fixed;
  left: 50%;
  top: 52vh; /* 50〜56vhで好みに調整 */
  transform: translate(-50%, -50%);
  width: min(28vmin, 320px);
  aspect-ratio: 3/5;
  background: url('assets/seraphia/seraphia_manifest.png') center/contain no-repeat;
  opacity: .12;
  filter: grayscale(100%) contrast(128%) brightness(128%);
  mix-blend-mode: screen;
  pointer-events: none; user-select: none;
  z-index: 3;
  animation: seraphiaSway 14s ease-in-out infinite;
}
.seraphia-silhouette::after{
  content:""; position:absolute; inset:-12%;
  background:
    radial-gradient(60% 60% at 50% 55%, rgba(255,220,160,.18), transparent 80%),
    radial-gradient(40% 40% at 50% 55%, rgba(255,240,210,.32), transparent 70%),
    radial-gradient(18% 18% at 50% 55%, rgba(255,255,255,.35), transparent 80%);
  filter: blur(14px);
  opacity: .9;
  animation: glowPulse 6s ease-in-out infinite;
  pointer-events: none;
}
@keyframes seraphiaSway{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-3px)} }
@keyframes glowPulse{ 0%,100%{ opacity:.8; filter:blur(12px) } 50%{ opacity:1; filter:blur(16px) } }

/* ───────── 囁き（中央下） ───────── */
.whisper{
  position: fixed;
  left: 50%;
  bottom: 7vh;
  transform: translateX(-50%);
  max-width: 42ch;
  text-align: center;
  color: #cbbfb6;
  font-style: italic;
  letter-spacing: .06em;
  z-index: 4;
  pointer-events: none; user-select: none;
}
.whisper .line{
  display:inline-block; opacity:0; filter: blur(.3px);
  animation: appear 1400ms ease forwards, breathe 6s ease-in-out infinite;
}
@keyframes appear{ to{ opacity:.85; transform:none } }
@keyframes breathe{ 0%,100%{ opacity:.85; transform:translateY(0) } 50%{ opacity:.45; transform:translateY(-3px) } }

/* フッター */
.mini{ display:flex; justify-content:center; padding:14px 0 24px }
.ghost{ background:transparent; border:1px solid rgba(255,255,255,.22); color:#e9e1d9; padding:.5rem .8rem; border-radius:8px; letter-spacing:.06em; cursor:pointer; transition:background .2s ease, transform .2s ease }
.ghost:hover{ background:rgba(255,255,255,.08); transform:translateY(-1px) }

/* モバイル細調整 */
@media (max-width:768px){
  .hero{ padding: 5vh 16px 8px; }
  .hero h1{ letter-spacing:.12em; font-size: clamp(22px, 6vw, 32px); text-shadow: none; }
  .subtitle{ font-size: clamp(11px, 3.8vw, 14px); opacity:.75; }
  .whisper{ bottom: calc(12px + env(safe-area-inset-bottom)); max-width: 30ch; font-size: clamp(11px, 3.4vw, 14px) }
}

/* ───────── 個別扉の仕上げ ───────── */

/* 鏡の間：鏡面だけを大きく、白ハイライトは出さない */
.door--1{
  --mirror-zoom: 180%;  /* 大きすぎれば 160% などに */
  --mirror-x: 50%; --mirror-y: 48%;
  background: none !important;
  background-image: url('assets/doors/door_mirror.png') !important;
  background-repeat: no-repeat !important;
  background-size: var(--mirror-zoom) !important;
  background-position: var(--mirror-x) var(--mirror-y) !important;
  border: none !important; box-shadow: none !important; outline: none !important;
  background-color: rgba(0,0,0,.25);
  filter: grayscale(100%) contrast(110%) brightness(98%);
  position: relative;
}
.door--1::before,
.door--1::after{ border:none !important; box-shadow:none !important; }
.door--1::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    linear-gradient(180deg, rgba(255,255,255,.10) 0%, transparent 35%),
    repeating-linear-gradient(90deg, rgba(255,255,255,.06) 0 1px, rgba(255,255,255,0) 1px 4px);
  mix-blend-mode: screen; opacity:.45; transition:opacity .4s ease;
}
.door--1::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background: radial-gradient(40% 60% at 78% 52%, rgba(255,200,120,.18), transparent 70%);
  mix-blend-mode: screen; opacity:.35; transition:opacity .4s ease, transform .6s ease;
}
@media (hover:hover){
  .door--1:hover{ transform: translate(-50%,-50%) scale(1.05) !important; filter: grayscale(100%) contrast(115%) brightness(103%) }
  .door--1:hover::before{ opacity:.6 }
  .door--1:hover::after{ opacity:.5; transform: translateX(-1px) }
}

/* 書斎の間：蝋燭が内側から“ほわっ”と広がる */
.door--2{
  --study-zoom: 180%;  /* 小さくするなら 160% 等に */
  --study-x: 50%; --study-y: 50%;
  background: none !important;
  background-image: url('assets/doors/door_study.png') !important;
  background-repeat: no-repeat !important;
  background-size: var(--study-zoom) !important;
  background-position: var(--study-x) var(--study-y) !important;
  border: none !important; box-shadow: none !important; outline: none !important;
  background-color: rgba(0,0,0,.25);
  filter: contrast(110%) brightness(104%) saturate(115%);
  position: relative;
  transition: transform .45s ease, filter .45s ease;
}
.door--2::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(circle at 50% 55%, rgba(255, 210, 150, .22), transparent 60%),
    radial-gradient(circle at 50% 55%, rgba(255, 190, 120, .15), transparent 80%);
  mix-blend-mode: screen; opacity:.25; transform: scale(0.95); filter: blur(2px);
  transition: opacity .8s ease, transform 1s ease, filter 1s ease;
}
.door--2::after{
  content:""; position:absolute; inset:0;
  background: radial-gradient(50% 60% at 50% 75%, rgba(255, 180, 100, .18), transparent 80%);
  mix-blend-mode: screen; opacity:.25; transition: opacity 1.2s ease;
}
@media (hover:hover){
  .door--2:hover{ transform: translate(-50%,-50%) scale(1.06) !important; filter: contrast(120%) brightness(110%) saturate(125%) }
  .door--2:hover::before{ opacity:.65; transform: scale(1.1); filter: blur(6px) }
  .door--2:hover::after{ opacity:.45 }
}
/* === 楕円リングの安定化：扉サイズを明示 === */
.hall-stage .doors--orbit .door{
  width: clamp(150px, 22vmin, 240px); /* ← 扉の大きさを固定（環境差で縮まず中央に収まる） */
  aspect-ratio: 3 / 4;
}

/* ステージの高さを少しだけ増やして余裕を持たせる */
.hall-stage{
  height: min(72vh, 680px);
}
/* === 楕円リングの安定化：扉サイズと表示を強制 === */
.hall-stage .doors--orbit{ position: relative !important; }

.hall-stage .doors--orbit .door{
  position: absolute !important;
  display: block !important;
  width: clamp(160px, 22vmin, 240px) !important;  /* 扉の基本サイズ */
  aspect-ratio: 3 / 4 !important;
  transform: translate(-50%, -50%);               /* JSで上書きされる前の初期値 */
  z-index: 1;
}
/* === セラフィア中央固定の強制リセット === */
.seraphia-silhouette{
  right: auto !important;       /* 旧：right: calc(...) を無効化 */
  left: 50% !important;
  top: 52vh !important;         /* 50〜56vhで好みに */
  transform: translate(-50%, -50%) !important;
  z-index: 3 !important;
}
/* === セラフィアは必ず中央 === */
.seraphia-silhouette{
  right: auto !important;
  left: 50% !important;
  top: 52vh !important;
  transform: translate(-50%, -50%) !important;
  z-index: 3 !important;
}

/* === 楕円リング安定化：扉の存在と大きさを強制 === */
.hall-stage .doors--orbit{ position: relative !important; }

.hall-stage .doors--orbit .door{
  position: absolute !important;
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  width: clamp(160px, 22vmin, 240px) !important; /* 扉サイズ固定 */
  aspect-ratio: 3 / 4 !important;
  transform: translate(-50%, -50%); /* JSが上書きする初期値 */
  z-index: 1;
}
/* === 祭壇ステージを画面の真ん中に固定（セラフィアと同じ基準） === */
.hall-stage{
  position: fixed !important;
  left: 50% !important;
  top: 52vh !important;              /* セラフィアの top と合わせる */
  transform: translate(-50%, -50%) !important;
  width: min(1100px, 92vw) !important;
  height: min(68vh, 640px) !important;
  margin: 0 !important;              /* 中央固定なので margin は不要 */
  z-index: 2;                         /* セラフィア(z=3)の一段下 */
}

/* ステージ内のリング枠はステージ一杯に広げる */
.hall-stage .doors--orbit{
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
}

/* 扉サイズを明示（環境差で縮まないよう固定） */
.hall-stage .doors--orbit .door{
  position: absolute !important;
  width: clamp(160px, 22vmin, 240px) !important;
  aspect-ratio: 3 / 4 !important;
  transform: translate(-50%, -50%);
  opacity: 1; visibility: visible;
}
/* 扉をほんの少し小さめに（ぶつかり防止・任意） */
.hall-stage .doors--orbit .door{
  width: clamp(150px, 20vmin, 230px) !important;
}
/* === 楕円ステージを大きく、画面中央に固定（強制） === */
.hall-stage{
  position: fixed !important;
  left: 50% !important;
  top: 52vh !important;                 /* セラフィアの top と同じ */
  transform: translate(-50%, -50%) !important;
  width: min(1200px, 96vw) !important;  /* ← ステージを拡大 */
  height: min(86vh, 760px) !important;  /* ← 高さも拡大 */
  margin: 0 !important;
  z-index: 2;
}
.hall-stage .doors--orbit{
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
}

/* 扉は少しだけ小さめにして、リングに余白を作る */
.hall-stage .doors--orbit .door{
  position: absolute !important;
  width: clamp(140px, 18vmin, 220px) !important;  /* ← 余白を確保 */
  aspect-ratio: 3 / 4 !important;
  transform: translate(-50%, -50%);
  opacity: 1; visibility: visible;
}

/* セラフィアは必ず中央（保険） */
.seraphia-silhouette{
  right: auto !important;
  left: 50% !important;
  top: 52vh !important;
  transform: translate(-50%, -50%) !important;
  z-index: 3 !important;
}
