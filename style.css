/* =====================================
   セラフィアの館 - 完全版スタイル
   ===================================== */

/* === 基本トークン === */
:root{
  --ink:#e9dfd6;
  --bg:#000;
}

/* === リセットとベース === */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body.hall{
  font-family:"Cormorant Garamond","Yu Mincho",serif;
  background:var(--bg);
  color:var(--ink);
  overflow:hidden;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}

/* === 星背景 === */
#dust{
  position:fixed;inset:0;display:block;
  z-index:0;
  contain:strict;
}

/* === タイトル === */
.hero{
  position:fixed;left:50%;top:8vh;transform:translateX(-50%);
  text-align:center;z-index:10;pointer-events:none;
}
.hero h1{
  font-family:"Cinzel",serif;
  letter-spacing:.18em;
  font-size:clamp(28px,6vw,60px);
  color:#f3eadf;
  text-shadow:0 0 22px rgba(255,240,200,.45),
               0 0 36px rgba(255,220,150,.22);
}
.hero .subtitle{
  font-style:italic;color:#d0c4b6;
  font-size:clamp(13px,2.4vw,18px);
  text-shadow:0 0 16px rgba(255,220,150,.28);
}

/* === ステージ === */
.hall-stage{
  position:fixed;inset:0;
  z-index:1;
  isolation:isolate;
}

/* === 扉（共通） === */
.doors--orbit{position:absolute;inset:0}
.doors--orbit .door{
  position:absolute;top:0;left:0;
  width:clamp(180px,22vmin,260px);
  aspect-ratio:3/4;
  transform:translate(var(--tx),var(--ty)) translate(-50%,-50%) scale(var(--pulse,1));
  background:center/contain no-repeat;
  filter:drop-shadow(0 6px 14px rgba(0,0,0,.55));
  transition:transform .45s ease,filter .45s ease;
  --depth:.5;
  z-index:0;
}
.doors--orbit .door::after{
  content:"";position:absolute;inset:-8%;
  background:radial-gradient(40% 48% at 50% 60%,color-mix(in oklab,var(--glow) 20%,transparent),transparent 70%);
  mix-blend-mode:screen;filter:blur(10px);opacity:.25;pointer-events:none;
}
.doors--orbit .door::before{
  content:"";position:absolute;inset:-18%;
  background:radial-gradient(120% 120% at 50% 60%,color-mix(in oklab,var(--glow) 18%,transparent) 0%,transparent 60%);
  mix-blend-mode:screen;filter:blur(18px);opacity:0;pointer-events:none;
  transition:opacity .35s ease,filter .35s ease,transform .35s ease;
}

/* --- 扉の画像と光色 --- */
.door--kagami{--glow:#c8d6ff;background-image:url('assets/doors/kagami.png')}
.door--shosai{--glow:#ffb36b;background-image:url('assets/doors/shosai.png')}
.door--reihaido{--glow:#9ad1ff;background-image:url('assets/doors/reihaido.png')}
.door--atorie{--glow:#ff99cf;background-image:url('assets/doors/atorie.png')}
.door--renkin{--glow:#7bffb0;background-image:url('assets/doors/renkin.png')}
.door--teien{--glow:#a7ff9a;background-image:url('assets/doors/teien.png')}
.door--shishitsu{--glow:#d3b8ff;background-image:url('assets/doors/shishitsu.png')}
.door--kyakushitsu{--glow:#ff9a9a;background-image:url('assets/doors/kyakushitsu.png')}
.door--gishiki{--glow:#ffd37a;background-image:url('assets/doors/gishiki.png')}

/* --- 奥行き表現 --- */
.doors--orbit .door{
  filter:drop-shadow(0 4px 14px rgba(0,0,0,.6))
          brightness(calc(.55 + var(--depth,.5)*.55))
          contrast(1.02)
          saturate(calc(.9 + var(--depth,.5)*.2))
          blur(calc((1 - var(--depth,.5))*0.6px));
}
@media (hover:hover){
  .doors--orbit .door:hover{
    transform:translate(var(--tx),var(--ty)) translate(-50%,-50%) scale(calc(1.05*var(--pulse,1)));
    filter:drop-shadow(0 10px 28px rgba(0,0,0,.8)) brightness(1.05);
  }
  .doors--orbit .door:hover::before{
    opacity:.32;filter:blur(22px);transform:scale(1.03);
  }
  .doors--orbit .door:hover::after{
    opacity:.6;filter:blur(14px);
  }
}

/* === セラフィア === */
.seraphia-silhouette{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  width:min(40vmin,440px);aspect-ratio:3/5;
  background:url('assets/seraphia/seraphia_manifest.png') center/contain no-repeat;
  mix-blend-mode:screen;
  opacity:.14;
  filter:grayscale(100%) contrast(120%) brightness(118%);
  z-index:500;pointer-events:none;
}
.seraphia-silhouette::before{
  content:"";position:absolute;inset:-14%;
  mix-blend-mode:lighten;
  background:
    conic-gradient(from -90deg at 50% 42%,rgba(255,240,210,.10),transparent 18%,rgba(255,240,210,.10) 36%,transparent 54%,rgba(255,240,210,.10) 72%,transparent 90%,rgba(255,240,210,.10) 100%),
    radial-gradient(62% 62% at 50% 56%,rgba(255,230,190,.28),transparent 80%);
  filter:blur(16px) brightness(1.06);
  opacity:.78;
  animation:halo 7s ease-in-out infinite;
}
@keyframes halo{
  0%,100%{filter:blur(16px) brightness(1.04);opacity:.74}
  50%{filter:blur(20px) brightness(1.10);opacity:.92}
}

/* === 囁き（中央下） === */
.whisper{
  position:fixed;left:50%;bottom:10vh;transform:translateX(-50%);
  width:min(94vw,900px);
  text-align:center;
  z-index:2000;
  pointer-events:none;user-select:none;
  -webkit-mask-image:linear-gradient(to bottom,rgba(0,0,0,1) 90%,rgba(0,0,0,0) 100%);
          mask-image:linear-gradient(to bottom,rgba(0,0,0,1) 90%,rgba(0,0,0,0) 100%);
}
.whisper::before{
  content:"";position:absolute;inset:-6% -8%;
  background:radial-gradient(40% 70% at 50% 60%,rgba(255,240,210,.08),transparent 70%);
  mix-blend-mode:lighten;filter:blur(12px);opacity:.55;
}
.whisper .line{
  position:absolute;left:50%;transform:translateX(-50%);
  display:inline-block;
  font-size:var(--whisper-fs,clamp(14px,2.1vw,18px));
  line-height:1.86;max-width:96%;max-height:36vh;
  white-space:pre-line;overflow:hidden;
  color:#cbbfb6;font-style:italic;letter-spacing:.055em;
  text-shadow:0 0 6px rgba(255,240,210,.18),0 0 18px rgba(255,230,180,.12);
  opacity:0;filter:blur(.25px);
}
.whisper .show{
  animation:whisperIn 1100ms ease forwards,whisperBreathe 9s ease-in-out infinite;
}
.whisper .hide{
  animation:whisperOut 900ms ease forwards;
}
@keyframes whisperIn{
  0%{opacity:0;transform:translate(-50%,6px)}
  100%{opacity:.85;transform:translate(-50%,0)}
}
@keyframes whisperOut{
  0%{opacity:.85;transform:translate(-50%,0)}
  100%{opacity:0;transform:translate(-50%,-4px)}
}
@keyframes whisperBreathe{
  0%,100%{opacity:.85;transform:translate(-50%,0)}
  50%{opacity:.52;transform:translate(-50%,-2px)}
}

/* === 儀式ボタン === */
.ritual-btn{
  position:fixed;right:24px;bottom:22px;
  padding:.55rem .9rem;font-size:14px;letter-spacing:.08em;
  color:#e9e1d9;background:rgba(255,255,255,.06);
  border:none;border-radius:999px;cursor:pointer;
  backdrop-filter:blur(6px);
  box-shadow:0 0 0 1px rgba(255,255,255,.10) inset,0 8px 22px rgba(0,0,0,.38);
  transition:transform .2s ease,background .3s ease;
}
.ritual-btn:hover{background:rgba(255,255,255,.10);transform:translateY(-1px)}
.ritual-btn::after{
  content:"";position:absolute;left:50%;top:50%;width:10px;height:10px;
  border-radius:50%;
  background:radial-gradient(circle,rgba(255,240,210,.35),transparent 60%);
  transform:translate(-50%,-50%) scale(0);opacity:0;
  transition:transform .6s ease,opacity .6s ease;
}
.ritual-btn:hover::after{transform:translate(-50%,-50%) scale(10);opacity:1}

/* === アクセシビリティ === */
@media(prefers-reduced-motion:reduce){
  .doors--orbit .door,
  .seraphia-silhouette::before,
  .whisper .show,
  .whisper .hide,
  .ritual-btn::after{
    animation:none!important;transition:none!important;
  }
}

/* === モバイル調整 === */
@media(max-width:768px){
  .hero{top:6vh}
  .seraphia-silhouette{width:min(46vmin,360px);opacity:.12}
  .whisper{bottom:max(10px,env(safe-area-inset-bottom));width:min(98vw,720px)}
  .whisper .line{line-height:1.78;max-height:42vh}
  .ritual-btn{right:14px;bottom:14px}
}
